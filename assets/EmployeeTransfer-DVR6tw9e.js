import{_ as I,r as n,o as F,a,b as t,d as g,t as r,w as S,f as k,i as T,F as C,e as _,v as E,g as o}from"./index-DQsCC5S4.js";import{g as x,a as B,f as M}from"./employeeApi-D5Bbbajn.js";const V={class:"employee-transfer"},D={key:0,class:"loading-message"},q={key:1,class:"error-message"},R={class:"form-group"},U=["value"],h={class:"form-group"},L=["value","disabled"],G={class:"form-group"},H={key:3,class:"success-message"},K={__name:"EmployeeTransfer",setup(P){const v=n(!0),l=n(null),c=n(""),A=n([]),m=n([]),i=n(""),f=n(""),d=n(null),N=async()=>{var p,e;v.value=!0,l.value=null;try{const s=await x();A.value=s.data;const u=[];for(const y of A.value)(await B(y.id)).data.filter(b=>b.accountType==="CHECKING"&&b.active).forEach(b=>{u.push({...b,userFullName:y.firstName+" "+y.lastName})});m.value=u}catch(s){l.value=((e=(p=s.response)==null?void 0:p.data)==null?void 0:e.message)||s.message||"Failed to load accounts."}finally{v.value=!1}},w=async()=>{var e,s;if(l.value="",c.value="",!m.value.find(u=>u.iban===i.value)){l.value="Invalid source account.";return}if(d.value<=0){l.value="Amount must be positive.";return}try{await M({fromIban:i.value,toIban:f.value,amount:d.value}),c.value="Transfer successful!",await N(),i.value="",f.value="",d.value=null}catch(u){l.value=((s=(e=u.response)==null?void 0:e.data)==null?void 0:s.message)||u.message||"Transfer failed."}};return F(()=>{N()}),(p,e)=>(o(),a("div",V,[e[9]||(e[9]=t("h2",null,"Initiate Transfer for Customer",-1)),e[10]||(e[10]=t("p",null,"Perform fund transfers between accounts on behalf of customers.",-1)),v.value?(o(),a("div",D,"Loading accounts...")):g("",!0),l.value?(o(),a("div",q,r(l.value),1)):g("",!0),v.value?g("",!0):(o(),a("form",{key:2,onSubmit:S(w,["prevent"])},[t("div",R,[e[4]||(e[4]=t("label",null,"Source Account (Customer & IBAN)",-1)),k(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>i.value=s),required:""},[e[3]||(e[3]=t("option",{value:"",disabled:""},"Select source account",-1)),(o(!0),a(C,null,_(m.value,s=>(o(),a("option",{key:s.iban,value:s.iban},r(s.userFullName)+" ("+r(s.iban)+") - €"+r(s.balance.toFixed(2)),9,U))),128))],512),[[T,i.value]])]),t("div",h,[e[6]||(e[6]=t("label",null,"Destination Account (Customer & IBAN)",-1)),k(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>f.value=s),required:""},[e[5]||(e[5]=t("option",{value:"",disabled:""},"Select destination account",-1)),(o(!0),a(C,null,_(m.value,s=>(o(),a("option",{key:s.iban+"-dest",value:s.iban,disabled:s.iban===i.value},r(s.userFullName)+" ("+r(s.iban)+") ",9,L))),128))],512),[[T,f.value]])]),t("div",G,[e[7]||(e[7]=t("label",null,"Amount (€)",-1)),k(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>d.value=s),min:"0.01",step:"0.01",required:""},null,512),[[E,d.value,void 0,{number:!0}]])]),e[8]||(e[8]=t("button",{type:"submit",class:"transfer-btn"},"Transfer",-1))],32)),c.value?(o(),a("div",H,r(c.value),1)):g("",!0)]))}},Q=I(K,[["__scopeId","data-v-cc7f1463"]]);export{Q as default};
